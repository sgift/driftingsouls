<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
    <head>
        <meta charset="utf-8">

        <title>Drifting Souls 2</title>

        <link rel="stylesheet" type="text/css" href="./data/css/format.css"/>
        <link rel="stylesheet" type="text/css" href="./data/css/ui-darkness/00_jquery-ui-1.8.20.css"/>
        <link rel="stylesheet" type="text/css" href="./data/css/ui-darkness/10_jquery-ui.css"/>

        <input type="hidden" name="currentDsModule" id="currentDsModule" value="base">
        <script src="./data/javascript/jquery.js" type="text/javascript"></script>
        <script src="./data/javascript/jquery.ui.js" type="text/javascript"></script>
        <script src="./data/javascript/jquery.blockUI.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/01_jquery.jqplot.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/02_jqplot.canvasAxisLabelRenderer.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/03_jqplot.canvasTextRenderer.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/04_jqplot.pieRenderer.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/10_query-ui-autocomplete-html-extension.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/20_angular-1.0.1.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/21_angular-locale_de.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/22_angular-ui.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/30_toastr.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/40_mustache.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/60_autoNumeric.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/grid.locale-de.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/jquery.jsPlumb-1.3.16-all.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/jquery-2.1.1.min.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/jquery.searchFilter.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/jquery-ui-1.11.2.min.js" type="text/javascript"></script>
        <script src="./data/javascript/libs/rhill-voronoi-core.js" type="text/javascript"></script>
        <script src="./data/javascript/facebox.js" type="text/javascript"></script>
        <script src="./data/javascript/common/purify.min.js" type="text/javascript"></script>
        <script src="./data/javascript/common/01_ds.js" type="text/javascript"></script>
        <script src="./data/javascript/common/02_cargomodel.js" type="text/javascript"></script>
        <script src="./data/javascript/common/03_itemlistmodel.js" type="text/javascript"></script>
        <script src="./data/javascript/common/05_dsbox.js" type="text/javascript"></script>
        <script src="./data/javascript/common/10_tooltips.js" type="text/javascript"></script>
        <script src="./data/javascript/common/20_autocomplete.js" type="text/javascript"></script>
        <script src="./data/javascript/common/21_cargoeditor.js" type="text/javascript"></script>
        <script src="./data/javascript/common/30_starmap.js" type="text/javascript"></script>
        <script src="./data/javascript/common/50_shiptypeBox.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.application.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.demo.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.directives.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.module.map.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.module.npc.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.module.techliste.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.service.ajax.js" type="text/javascript"></script>
        <script src="./data/javascript/common/angular.service.ds.js" type="text/javascript"></script>
        <script src="./data/javascript/modules/base.js" type="text/javascript"></script>
        <script src="./data/javascript/modules/basis.templates.js" type="text/javascript"></script>
        <script type="text/javascript">
            jQuery(document).ready(function ($) {
                $('a[rel*=facebox]').facebox()
            })
        </script>
    </head>
    <body>
        <div class="gfxbox" id="error-placeholder" th:if="${error}" style="width:470px;display:flex;justify-content:center;">
            <div style="text-align:center; font-size:14px; font-weight:bold">Es sind Fehler aufgetreten:</div>
            <ul>
                <li>
                    <a class="error" style="font-size:14px; font-weight:normal" href="./ds?module=basen&amp;action=default" th:utext="${error.text}">Die angegebene Kolonie existiert nicht</a>
                </li>
            </ul>
        </div>
        <div id="baseContent" th:if="${error == null}">
            <div class="container" style="margin:auto;">
                <div class="row">
                    <div class="col gfxbox" style="flex-direction:row;justify-content:space-between;display:flex;">
                        <span>
                            <input type="hidden" id="baseId" th:value="${base.getId()}" style="margin-left:5px;margin-right:5px;"/>
                            <a style="margin-left:5px;margin-right:5px;display: inline-flex;" title="Zur Sternenkarte wechseln" class="forschinfo" th:href="'starmap?system='+${base.getSystem()}+'&x='+${base.getX()}+'&y='+${base.getY()}" >
                                <img src="data/interface/impobjects.gif" alt="?"><span style="align-self: baseline;">[(${base.getSystem()})]:[(${base.getX()})]/[(${base.getY()})]</span>
                            </a>
                            <span style="margin-left:2px;margin-right:2px;" id="baseName" th:utext="${base.getPlainName()}+' ('+${base.getId()}+')'">Koloniename (ID)</span>
                            <span id="baseNameForm" style="display:none">
                                <form th:action="@{base}" method="post" style="display:inline">
                                    <input name="newname" class="fsinput" type="text" size="15" maxlength="50" th:value="${base.getPlainName()}">
                                    <input name="col" type="hidden" th:value="${base.getId()}">
                                    <input name="module" type="hidden" value="base">
                                    <input name="action" type="hidden" value="changeName">&nbsp;
                                    <input type="submit" value="umbenennen"  class="fsSubmit" >
                                </form>
                            </span>

                            <img th:if="${not scan}" style="vertical-align:middle; border:0px" src="./data/interface/pen.gif" alt="Namen &auml;ndern" onclick="Base.changeName()">
                        </span>
                        <span id="cargo_uebersicht">
                            Verf&uuml;gbarer Cargo: [(${base.getCargoEmpty()})] ([(${base.getCstat_formated()})]) / [(${base.getMaxCargo_formated()})]
                        </span>
                    </div>
                </div>
                <div class="row" style="flex-direction:row-reverse;">
                    <div th:if="${not scan}" class="col gfxbox wms" style="display: flex;flex-direction:column;flex-grow: 1;flex-basis: 300px;max-height: 800px;">

                        <div class="row" style="max-height: 750px;">
                            <div class="col">
                                <div id="aktionen-asteroid" class="ueberlauf" style="min-width:315px;overflow-y: auto;max-height:750px;">
                                    <div class="row" style="margin-bottom:15px;margin-left:-10px;">
                                        <div class="col">

                                        </div>
                                    </div>
                                    <ul class="buildingActions" >
                                        <li class="buildingAction"  th:each="building : ${buildings}" th:onmouseover="|Base.highlightBuilding('building${building.id}')|" onmouseout="Base.noBuildingHighlight()"  th:data-on="${building.isAllowon()}" th:data-off="${building.isAllowoff()}">
                                            [(${building.building.getPlainName()})]
                                            <span>
                                                <a th:if="${building.isAllowoff()}" title="Geb&auml;ude deaktivieren" class="action deaktivieren" th:href="@{/base(action='changeBuildingStatus',col=${base.getId()},buildingonoff=${building.id},act='0')}">
                                                    <img alt="" src="./data/interface/nenergie.gif">
                                                </a>
                                                <a th:if="${building.isAllowon()}" title="Geb&auml;ude aktivieren" class="action aktivieren" th:href="@{/base(action='changeBuildingStatus',col=${base.getId()},buildingonoff=${building.id},act='1')}">
                                                    <img alt="" src="./data/interface/energie.gif">
                                                </a>
                                            </span>
                                        </li>

                                        <li style="border-bottom:1px solid grey;margin-top:5px;margin-bottom:5px;"> </li>
                                        <li>Gespeicherte Energie: <span id="stored_energy" style="float:right;margin-right:5px;" th:utext="${base.getEnergy_formated()}">base.energy</span></li>
                                        <li>Energiebilanz: <span id="energydiff" style="float:right;margin-right:5px;" th:utext="${base.getEstat_formated()}">base.estat</span></li>

                                        <li style="border-bottom:1px solid grey;margin-top:5px;margin-bottom:5px;justify-content:center;"> </li>
                                        <li style="text-align:center;justify-content:center;"><a style="font-size:14px" class="ok" th:href="@{/base(action='activateall',col=${base.getId()})}">Alles aktivieren</a></li>
                                        <li style="text-align:center;justify-content:center;"><a style="font-size:14px" class="error" th:href="@{/base(action='activateall',col=${base.getId()}, deaconly='1')}">Alles deaktivieren</a></li>



                                        <li style="border-bottom:1px solid grey;margin-top:5px;margin-bottom:5px;justify-content:center;"> </li>
                                        <li th:if="${base.isFeeding()}" style="text-align:center;justify-content:center;"><a style="font-size:14px" class="ok" th:href="@{/base(action='changeFeeding',col=${base.getId()},feeding='0')}">Versorgung abschalten</a></li>
                                        <li th:if="${not base.isFeeding()}" style="text-align:center;justify-content:center;"><a style="font-size:14px" class="error" th:href="@{/base(action='changeFeeding',col=${base.getId()},feeding='1')}">Versorgung anschalten</a></li>
                                    </ul>
                                </div>
                                <div id="baumenu-asteroid" class="ueberlauf" style="display: none;min-width: 315px;overflow-y: auto;max-height: 750px;">
                                    <div style="display: flex;flex-direction: column;align-items: center;">
                                        <div class="gfx-tab-nav" style="margin-left:-15px;margin-right:-15px;" >
                                            <span th:each="kategorie : ${kategorien}" class="geb-kategorie-auswahl" th:style="${kategorie.name.equals('Sonstiges')}? 'border-right:none;':' '" th:data-click="'geb_'+${kategorie.name}" onclick="tabWechsel(this,this.getAttribute('data-click'))" th:text="${kategorie.name}">Kategorie</span>
                                        </div>
                                    </div>
                                    <div th:each="kategorie: ${kategorien}" th:id="'geb_'+${kategorie.name}" class="tab-element" th:style="${kategorie.name.equals('Energie')}? '':'display:none'">
                                        <div th:each="build:${kategorie.gebaeude}">
                                            <button type="button" th:class="'btn-geb-info geb'+${build.building.getId()}" style="" th:data-click="${build.building.getId()}" onclick="Base.SelectBuilding(this,this.getAttribute('data-click'))">
                                                <span style="align-self:center;"><img th:src="${build.building.getPictureForRace(base.getOwner().getRace())}" alt=""></span>
                                                <span class="geb-name" style="" th:utext="${build.building.getPlainName()}">Geb&auml;udename</span>
                                                <span th:data-ds-geb-id="${build.building.getId()}" style="align-self:center;">
                                                    <span th:each="res : ${build.baukosten}" th:style="${res.getDiff()}>0? 'color:red':''">
                                                        <img th:src="${res.getImage()}" alt="" th:title="${res.getPlainName()}">[(${res.getCargo1()})]
                                                    </span>
                                                </span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="verwaltung-bauen" class="row" style="height:40px;min-width:315px">
                            <button type="button" class="fsbutton link aktiv" onclick="toggleBaumenu()" style="position:absolute;bottom:-33px;right:-33px;;z-index:10;background-color:transparent;background-image: url(./data/interface/green/button150_BR.svg);border-width: 0px;border: none;width:150px;height:50px;">
                                <span class="button-text" style="" >Verwaltung</span>
                            </button>
                            <button class="fsbutton link" onclick="toggleBaumenu()" style="z-index:10;border-left:2px solid grey;background-color:transparent;background-image: url(./data/interface/green/button150_tl.svg);border-width: 0px;border: none;width:150px;height:50px;position:absolute;bottom:-33px;right:107px;">
                                <span class="button-text" style="" >Baumen&uuml;</span>
                            </button>
                        </div>
                    </div>


                    <div class="col gfxbox wmd" style="flex-grow: 10;flex-basis: 410px;max-height: 800px">
                        <div class="row" style="margin-bottom:15px;margin-top:5px;margin-left:-10px;">
                            <div class="col">
                                Core:
                                <a th:if="${base.getCore()}" th:class="${base.isCoreActive()}?'ok':'error'" th:href="@{ds(module='core',action='default',col=${base.getId()})}" th:utext="${base.getCore().getPlainName()}">CoreName</a>
                                <a th:if="${base.getCore() == null}" th:remove="${scan} ? 'tag'" class="ok" th:href="@{ds(module='core',action='default',col=${base.getId()})}" >leer</a>
                            </div>
                        </div>
                        <div class="row ueberlauf" style="overflow-y:auto;">
                        </div>
                        <div id="baseMap" th:style="'width:'+${base.getMapWidth()}+'px; height:'+${base.getCargoHeight()}+'px;'" >
                            <div th:each="tilerow : ${tiles}" class="tilerow">
                                <div th:each="tile: ${tilerow}" class="tile">
                                    <div th:class="'p'+${tile.id}+(${tile.building}?' building'+${tile.buildingId}:' bebaubar')+(${tile.isOverlay()}?' offline':'')" th:data-overlay="${tile.isOverlay()}" th:data-field="${tile.id}" th:attrappend="onclick=${tile.building} ? '': 'Base.BaueFeld(this.parentNode, this.getAttribute(\'data-field\'))'">
                                        <a th:remove="${not tile.building}? tag" class="tooltip" th:href="@{ds(module='building',col=${base.getId()},field=${tile.field})}" th:data-field="${tile.field}" th:attrappend="onclick=${tile.isBuildingJson()} ? 'Base.showBuilding(this.getAttribute(\'data-field\'));return false;' :''">
                                            <span th:if="${tile.building}" class="ttcontent" th:text="${tile.buildingName}">Geb&auml;udename</span>
                                            <img style="border:0px" th:src="${tile.buildingImage}" alt="">
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ul class="buildingActions" style="margin-top:25px;">
                            <li style="border-bottom:1px solid grey;margin-top:5px;margin-bottom:5px;"> </li>
                            <li>Bev&ouml;lkerung: <span id="bevoelkerung" th:text="${base.getBewohner_formated()}"> Bev&ouml;lkerung: x</span></li>
                            <li>Arbeiter ben&ouml;tigt: <span id="arbeiter" th:text="${base.getArbeitetNeeded_formated()}"> Arbeiter ben&ouml;tigt: x</span></li>
                            <li>Wohnraum: <span id="wohnraum" th:text="${base.getLivingSpace_formated()}"> Wohnraum: x</span></li>
                        </ul>
                        <div id="statsBox" style="width:100%;">
                            <div class="row" style="margin-left:5px;margin-right:5px;min-height: 15px;" title="Anteil arbeitender Bev&ouml;lkerung">
                                <div th:each="i : ${#numbers.sequence(1,bevoelkerung.arbeiter / 1000,1)}" class="arbeiteranzeige arbeiteranzeige-voll" th:data="${i}" th:data-bv="${bevoelkerung.arbeiter / 1000}">
                                </div>
                                <div class="arbeiteranzeige" th:style="'width:'+${0.08*(bevoelkerung.arbeiter % 1000)}+'px;'" >
                                </div>
                            </div>
                            <div class="row " style="margin-left:5px;margin-right:5px;min-height: 15px;" title="Anteil arbeitsloser Bev&ouml;lkerung">
                                <div th:each="i : ${#numbers.sequence(1,bevoelkerung.arbeitslos / 1000,1)}" class="arbeitslosenanzeige arbeiteranzeige-voll tooltip" th:data="${i}" th:data-bv="${bevoelkerung.arbeitslos / 1000}">
                                </div>
                                <div class="arbeitslosenanzeige " th:style="'width:'+${0.08*(bevoelkerung.arbeitslos % 1000)}+'px;'">
                                </div>
                            </div>
                            <div class="row " style="margin-left:5px;margin-right:5px;min-height: 15px;" title="Freier Wohnraum f&uuml;r neue Bev&ouml;lkerung. Bev&ouml;lkerung wandert zu.">
                                <div th:each="i : ${#numbers.sequence(1,bevoelkerung.wohnraumFrei / 1000,1)}" class="wohnraumfreianzeige arbeiteranzeige-voll" th:data="${i}" th:data-bv="${bevoelkerung.wohnraumFrei / 1000}">
                                </div>
                                <div class="wohnraumfreianzeige " th:style="'width:'+${0.08*(bevoelkerung.wohnraumFrei % 1000)}+'px;'">
                                </div>
                            </div>
                            <div class="row" style="margin-left:5px;margin-right:5px;min-height: 15px;" title="Fehlender Wohnraum f&uuml;r aktuelle Bev&ouml;lkerung. Bev&ouml;lkerung wandert ab!">
                                <div th:each="i : ${#numbers.sequence(1,bevoelkerung.wohnraumFehlt / 1000,1)}" class="wohnraumfehltanzeige arbeiteranzeige-voll " th:data="${i}" th:data-bv="${bevoelkerung.wohnraumFehlt / 1000}">
                                </div>
                                <div class="wohnraumfehltanzeige " th:style="'width:'+${0.08*(bevoelkerung.wohnraumFehlt % 1000)}+'px;'">
                                </div>
                            </div>
                        </div>
                        <div class="row" style="height:15px;">
                            <button type="button" disabled class="fsbutton" onclick="toggleBaumenu()" style="position:absolute;bottom:-33px;right:-33px;z-index:10;box-sizing:border-box;background-color:transparent;background-image: url(./data/interface/green/button150_tl_BR.svg);border-width: 0px;border: none;width:150px;height:50px;">
                                <span class="button-text" >Basis</span>

                            </button>
                        </div>
                    </div>

                    <div class="col gfxbox wsm" style="flex-grow: 1;flex-basis:340px; max-height: 800px;">
                        <div id="cargo-asteroid">
                            <div style="display:flex;flex-direction:row;justify-content:center;">
                                <div class="gfx-tab-nav" style="">
                                    <span class="geb-kategorie-auswahl" th:each="cargotyp : ${cargo}" th:data-click="${cargotyp.getName()}" onclick="tabWechsel(this, this.getAttribute('data-click'))" th:style="${cargotyp.getName().equals('Sonstiges')}? 'border-right:none;':' '"  th:inline="text">[[${cargotyp.getName()}]]<span style="margin-left:2px;font-size:90%;color:darkgoldenrod;"th:utext="'('+${cargotyp.getAmount()}+')'"></span></span>
                                </div>
                            </div>
                            <div th:each="cargotyp : ${cargo}" th:id="${cargotyp.getName()}" class="gfx-tab tab-element ueberlauf" th:style="${cargotyp.getName().equals('Waren')}? 'display:block; max-height:700px;overflow-y:auto;overflow-x:hidden;':''">
                                <div class="row" style="justify-content:center;">
                                    <table class="ressources-table" style="border:none;text-align:right;">
                                        <tbody>
                                            <tr th:each="res : ${cargotyp.getRess()}">
                                                <td>
                                                    <img th:src="${res.getImage()}" alt="">
                                                </td>
                                                <td>
                                                    <span th:utext="${res.getName()}"></span>
                                                </td>
                                                <td>
                                                    <span th:utext="${res.getCargo1()}"></span>
                                                </td>
                                                <td>
                                                <span th:if="${res.getCount2()}" th:utext="${res.getCargo2}"></span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                        </div>
                        <div id="einheiten-asteroid" style="display:none; margin:20px">
                            <div th:each="unit:${units}">
                                <img style="vertical-align:middle"  th:src="${unit.getUnitType().getPicture()}" alt="" />
                                <a class="forschinfo" th:href="@{ds(module='unitinfo',action='default',unit=${unit.getUnitTypeId()})}" th:text="${unit.getUnitType().getName()}">Einheit</a> <span th:text="${unit.getAmount_formated()}">{unit.count}</span><br />
                            </div>
                        </div>
                        <div id="lager-einheiten" class=" row" style="height:40px;">
                            <button type="button" class="fsbutton link aktiv" onclick="toggleLagermenu()" style="position:absolute;bottom:-33px;right:-33px;;z-index:10;background-color:transparent;background-image: url(./data/interface/green/button150_BR.svg);border-width: 0px;border: none;width:150px;height:50px;">
                                <span class="button-text" style="position:relative;top:-0px;" >Cargo</span>
                            </button>
                            <button class="fsbutton link" onclick="toggleLagermenu()" style=";z-index:10;border-left:2px solid grey;background-color:transparent;background-image: url(./data/interface/green/button150_tl.svg);border-width: 0px;border: none;width:150px;height:50px;position:absolute;bottom:-33px;right:107px;">
                                <span class="button-text" style="" >Einheiten</span>
                            </button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <div id="tt_div" style="display: none"></div>
        <!-- hier wird von wo anders der Schluss eingef&uuml;gt -->
        <script type="text/javascript">
            if (parent && parent.setCurrentPage) {
                parent.setCurrentPage('base', 'Basis');
                parent.completePage();
            }
        </script>
    </body>
</html>
