<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="de" lang="de">
<head>
    <meta charset="utf-8">

    <title>Drifting Souls 2</title>

    <link rel="stylesheet" type="text/css" href="./data/css/format.css"/>
    <link rel="stylesheet" type="text/css" href="./data/css/ui-darkness/00_jquery-ui-1.8.20.css"/>
    <link rel="stylesheet" type="text/css" href="./data/css/ui-darkness/10_jquery-ui.css"/>
    <link rel="stylesheet" type="text/css" href="./data/css/starmapNew.css"/>
    <link rel="stylesheet" type="text/css" href="./data/css/starmapScanfields.css"/>

    <input type="hidden" name="currentDsModule" id="currentDsModule" value="base">
    <script src="./data/javascript/jquery.js" type="text/javascript"></script>
    <script src="./data/javascript/jquery.ui.js" type="text/javascript"></script>
    <script src="./data/javascript/jquery.blockUI.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/01_jquery.jqplot.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/02_jqplot.canvasAxisLabelRenderer.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/03_jqplot.canvasTextRenderer.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/04_jqplot.pieRenderer.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/10_query-ui-autocomplete-html-extension.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/20_angular-1.0.1.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/21_angular-locale_de.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/22_angular-ui.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/30_toastr.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/40_mustache.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/60_autoNumeric.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/grid.locale-de.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/jquery.jsPlumb-1.3.16-all.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/jquery-2.1.1.min.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/jquery.searchFilter.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/jquery-ui-1.11.2.min.js" type="text/javascript"></script>
    <script src="./data/javascript/libs/rhill-voronoi-core.js" type="text/javascript"></script>
    <script src="./data/javascript/facebox.js" type="text/javascript"></script>
    <script src="./data/javascript/common/purify.min.js" type="text/javascript"></script>
    <script src="./data/javascript/common/01_ds.js" type="text/javascript"></script>
    <script src="./data/javascript/common/02_cargomodel.js" type="text/javascript"></script>
    <script src="./data/javascript/common/03_itemlistmodel.js" type="text/javascript"></script>
    <script src="./data/javascript/common/05_dsbox.js" type="text/javascript"></script>
    <script src="./data/javascript/common/10_tooltips.js" type="text/javascript"></script>
    <script src="./data/javascript/common/20_autocomplete.js" type="text/javascript"></script>
    <script src="./data/javascript/common/21_cargoeditor.js" type="text/javascript"></script>
    <script src="./data/javascript/common/30_starmap.js" type="text/javascript"></script>
    <script src="./data/javascript/common/50_shiptypeBox.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.application.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.demo.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.directives.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.module.map.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.module.npc.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.module.techliste.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.service.ajax.js" type="text/javascript"></script>
    <script src="./data/javascript/common/angular.service.ds.js" type="text/javascript"></script>

    <script type="text/javascript">
            jQuery(document).ready(function ($) {
                $('a[rel*=facebox]').facebox()
            })
        </script>
</head>
<body style="background-image: url(https://ds2.drifting-souls.net/data/interface/portal/bg2.jpg);">

<div id="mapmenubar" class="gfxbox ng-scope">
    <div class="content">
        <a id="showSystemauswahl" title="System auswÃ¤hlen" onclick="$('#systemauswahl').dialog('open')" href="#"><img src="data/interface/impobjects.gif" alt="?"></a>
        <a id="gotoLocation" title="Zu Position springen" onclick="starmap.loadImpObjects()" href="#"><img src="data/interface/goto.svg" alt="?"></a>
        <a id="showStarmap" title="Bekannte Sternensysteme" onclick="loadStarSystemMap()" href="#"><img src="data/interface/jumpnode.svg" alt="?"></a>
        <a id="reloadStarmap" onclick="ReloadSystem()"><img src="data/interface/reload.svg" alt="?" style="width:19px;" class="clickable"></a>
    </div>
</div>

<div style="position: absolute;top:25px;left:60px;right:20px;bottom:35px;clip-path: polygon(0px 21px, 21px 0px, calc(100% - 21px) 0px, 100% 21px, 100% calc(100% - 21px), calc(100% - 21px) 100%, 21px 100%, 0px calc(100% - 21px));background-color:rgb(38, 49, 42);">
    <div id="starmap" style="position: absolute;top:3px;left:3px;right:3px;bottom:3px;overflow:hidden;clip-path: polygon(0px 20px, 20px 0px, calc(100% - 20px) 0px, 100% 20px, 100% calc(100% - 20px), calc(100% - 20px) 100%, 20px 100%, 0px calc(100% - 20px));background-color: black;">
        <div id="legend-top-left" style="position:absolute;top:0;left:0;width:25px;height:25px;background-color:black;z-index:75;"></div>
        <div id="legend-top-right" style="position:absolute;top:0;right:0;width:25px;height:25px;background-color:black;z-index:75;"></div>
        <div id="legend-bottom-right" style="position:absolute;bottom:0;right:0;width:25px;height:25px;background-color:black;z-index:75;"></div>
        <div id="legend-bottom-left" style="position:absolute;bottom:0;left:0;width:25px;height:25px;background-color:black;z-index:75;"></div>
        <div id="legend-top" style="position:absolute;top:0;height:25px;left:25px;z-index:60;background-color:black;z-index:70;">
            <div class="scroll-x" style="position: absolute;left: 0px;top: 0;bottom: 0;display: flex;font-size: 9px;overflow: hidden;background-color:black;"></div>
        </div>
        <div id="legend-left" style="position:absolute;top:25px;width:25px;left:0px;z-index:60;background-color:black;z-index:70;">
            <div class="scroll-y" style="position: absolute;left: 0px;top: 0;right: 0;display:flex;flex-direction:column;font-size: 9px;overflow: hidden;background-color:black;"></div>
        </div>
        <div id="legend-right" style="position:absolute;top:25px;right:0;width:25px;z-index:60;background-color:black;z-index:70;">
            <div class="scroll-y" style="position: absolute;left: 0px;top: 0;right: 0;display:flex;flex-direction:column;font-size: 9px;overflow: hidden;background-color:black;"></div>
        </div>
        <div id="legend-bottom" style="position:absolute;bottom:0;left:25px;height:25px;z-index:60;background-color:black;z-index:70;">
            <div class="scroll-x" style="position: absolute;left: 0px;top: 0;bottom: 0;display: flex;font-size: 9px;overflow: hidden;background-color:black;"></div>
        </div>
        <div id="draggable" class="dragme" style="position: absolute;top:25px;left:25px;right:25px;bottom:25px;font-size:0px;will-change:transform;">

            <div id="tiles" style="position:absolute;top:0px;left:0px;">

            </div>
            <div id="scansectors" style="position:absolute;top:0px;left:0px;opacity:0.5;background-color:black;mix-blend-mode:darken;">
            </div>
            <div id="scannedSectors" style="position:absolute;top:0px;left:0px;right:0px;bottom:0px;display:grid;">

            </div>
            <div id="position-marker" style="position:absolute;display:none;left:0;top:0;width:25px;height:25px;border:1px solid blue; pointer-events:none;"></div>
            <div id="scanrange-marker" class="scanrange" style="position:absolute;display:none;left:0;top:0;pointer-events:none;"></div>
        </div>
        <div id="starmap-mouse-event-target" class="dragme" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; z-index: 100;"></div>
    </div>
</div>
<div id="kartenaktion" style="right:25px;bottom:0px;position:absolute;font-size:75%;padding:2px 5px;color:#c7c7c7;border-radius:4px 4px 0 0;background:rgba(50,50,50,0.70);display:none;">
    <!-- uiIf: fokusaktion.aktion=='flug' --><span ui-if="fokusaktion.aktion=='flug'" class="ng-scope">
		<!-- uiIf: fokusaktion.ziel --><span id="flightConfirmationText" ui-if="fokusaktion.ziel" class="ng-scope ng-binding">

		</span>
    <!-- uiIf: !fokusaktion.ziel -->
	</span>
    <span class="abbruch" onclick="starmap.abortFlight()">Abbruch</span>
    <!-- uiIf: fokusaktion.ziel --><span class="bestaetigung" onclick="starmap.confirmFlight()">Ja</span>
</div>

<div id="kartenaktionslog" class="ng-scope">
    <div class="log" list="log" entry="entry">
        <div class="logcontainer">
            <div class="logentries">
                <!-- ngRepeat: entry in logentries -->

            </div>
        </div>

        <span class="toggleSize" title="zuklappen"></span>
    </div>
</div>


<div id="systemauswahl" class="gfxbox" style="display:none;width:400px;height:160px;" title="Kartenausschnitt">
    <div ds-popup="systemSelection" ds-popup-title="Kartenausschnitt" ds-popup-width="400" ng-controller="MapSystemauswahlController" class="" style="min-height: 160px; max-height: none; height: auto;">
        <form id="systemauswahl-form" class="ng-pristine ng-valid">
            <table cellpadding="3">
                <tbody><tr>
                    <td colspan="2">
                        System<br>
                        <select name="system" class="ng-pristine ng-valid" style="min-width:200px;">
                            <option th:each="system : ${starsystems}" th:value="${system.id}" th:text="${system.name}"></option>
                        </select>
                    </td>
                </tr>
                <tr>
                    <td>
                        Position
                    </td>
                    <td>
                        <input type="text" name="x" size="3" value="1" class="ng-pristine ng-valid">
                        /
                        <input type="text" name="y" size="3" value="1" class="ng-pristine ng-valid">
                    </td>
                </tr>
                <tr ng-show="adminSichtVerfuegbar" style="display: none;">
                    <td colspan="2">
                        <input type="checkbox" ng-model="adminSicht" id="adminSicht" name="adminSicht" class="ng-pristine ng-valid"><label for="adminSicht">Admin-Sicht</label>
                    </td>
                </tr>
                </tbody></table>
            <input type="button" value="Sternenkarte laden" onclick="LoadSystem(new FormData(document.getElementById('systemauswahl-form')))">
        </form>
    </div>
</div>

<div id="goto-location" class="gfxbox" style="display:none; width: auto; min-height: 0px; max-height: none; height: 328px;" title="Zur Position springen">
    <form id="goto-location-form">
        <div class="bekannteObjekte">

        </div>
        <label>Eigene Position eingeben</label>
        <input id="goto-x" type="text" size="3" class="" value="1">/
        <input id="goto-y" type="text" size="3" class="" value="1">
        <input type="button" onclick="starmap.setCoordinates($('#goto-location-form #goto-x').val(), $('#goto-location-form #goto-y').val())" style="width:200px;" value="los!">
    </form>
</div>



<div id="starmapSectorPopup" class="gfxbox" style="display:none; width: auto; min-height: 0px;" title="Sektorinformationen">
    <div style="">
        <div class="header"></div>
        <!-- uiIf: sektor.roterAlarm -->
        <!-- uiIf: sektor.nebel -->
        <!-- uiIf: sektor.jumpnodes.length>0 -->
        <!-- uiIf: sektor.bases.length>0 -->
        <!-- uiIf: sektor.brocken.length>0 -->
        <!-- uiIf: sektor.battles.length>0 -->
        <!-- uiIf: sektor.subraumspaltenCount>0 -->
        <div id="sektoranzeige" class="ships" style="display: flex;flex-direction: column;max-height:650px;overflow-x:hiden;">

        </div>
    </div>
</div>
<div id="starmaploader" class="gfxbox" style="width: 400px;">
    <div class="content">Empfange Daten...
        <br>
        <img src="./data/interface/ajax-loader.gif" alt="Lade">
    </div>
</div>

<div id="shiptype-container">

</div>

<div id="starsystem-map">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 800 600" version="1.1" style="width:100%;height:100%;">

        <style>
						.system{
							fill:none;
							stroke-width:2;
							stroke:rgb(0, 100, 0);
						}
						.system-text{

						}
						.spherelines
						{
							stroke:rgb(0,150,0);
							fill: transparent;
							stroke-width: 0.5;
						}
						.systemConnection{
							stroke-width:2;
							stroke:rgb(50, 50, 50);
							stroke-linecap: round;
							pointer-events: all;
						}
						.systemConnection:hover{
							stroke-width:4;
							cursor: pointer;
						}
						.systemRing{
							pointer-events: all;
						}
						.systemRing:hover{
							cursor: pointer;
						}
						path{
							pointer-events: none;
						}
						circle{
							pointer-events: none;
						}
						line{
							pointer-events:none;
						}
					</style>

        <defs id="defs">
            <filter id="lightingFilter" filterUnits="objectBoundingBox">
                <feGaussianBlur stdDeviation="30" result="blur1"/>
                <feSpecularLighting result="specOut" in="blur1" specularConstant="4" specularExponent="30" lighting-color="limegreen">
                    <feDistantLight azimuth="225" elevation="45"/>
                </feSpecularLighting>
                <feComposite in="SourceGraphic" in2="specOut" operator="arithmetic" k1="0" k2="1" k3="1" k4="0" result="result"/>
                <feComposite operator="atop" in2="SourceGraphic"/>
                <feColorMatrix type="matrix" values=
                        "1 0 0 0 0,
					0 1 0 0 0,
					0 0 1 0 0,
					0 0 0 0.6 0" result="fullOpacity"/>
                <feColorMatrix in="SourceAlpha" type="matrix" values=
                        "0 0 0 0 0,
					0 0 0 0 0,
					0 0 0 0 0,
					0 0 0 5 0" result="fullOpacitySource"/>
                <feComposite operator="in" in="fullOpacity" in2="fullOpacitySource" result="COMPOSITE"/>
            </filter>

            <radialGradient id="defaultRingGradient">
                <stop offset="5%" stop-color="rgba(0, 80, 0, 1)" />
                <stop offset="45%" stop-color="rgba(0, 100, 0, 0.6)" />
                <stop offset="80%" stop-color="rgba(0, 100, 0, 0.4)" />
                <stop offset="100%" stop-color="rgba(0, 100, 0, 0.3)" />
            </radialGradient>
        </defs>

        <g id="starsystemmap-svg">


        </g>
    </svg>
</div>

<style>
    .starmap-modal
    {
        z-index: 200;
        border: 4px solid rgb(38, 49, 42);
        background: rgb(15, 21, 19);
    }
</style>

<script src="./data/javascript/starmap.templates.js" type="text/javascript"></script>
<script src="./data/javascript/starmapDrag.js" type="text/javascript"></script>
<script src="./data/javascript/starmapNew.js" type="text/javascript"></script>
<script src="./data/javascript/starmapVoronoi.js" type="text/javascript"></script>

<script>
    let systemFormData = new FormData();
    systemFormData.set("system", [(${system})]);
    systemFormData.set("x", [(${x})]);
    systemFormData.set("y", [(${y})]);
    LoadSystem(systemFormData);

    $("#systemauswahl").dialog({
        dialogClass: 'starmap-modal',
        width: 400
    });

    $("#goto-location").dialog({
        dialogClass: 'starmap-modal',
        width: 400
    });

        $("#starmapSectorPopup").dialog({
        dialogClass: 'starmap-modal',
        width: 550,
        minHeight:500,
        height: 'auto',
        maxHeight: 600
    });

    $(".starmap-modal").each(function(){
        $(this).mousedown(function(e){e.originalEvent.stopPropagation();});
    });

    $("#starmaploader").dialog({
        dialogClass: 'starmap-modal',
        width: 400
    });

    $("#starsystem-map").dialog({
        dialogClass: 'starmap-modal starsystem-map-background',
        width: 900,
        height: 700
    });

    $("#systemauswahl").dialog("close");
    $("#goto-location").dialog("close");
    $("#starmapSectorPopup").dialog("close");
    $("#starmaploader").dialog("close");
    $("#starsystem-map").dialog("close");

    $(document.querySelector(".log")).find('.toggleSize').on('click', function(event) {
        let element = $(document.querySelector(".log"));
        element.toggleClass('expanded');
        $(event.target).attr('title', element.hasClass('expanded') ? 'zuklappen' : 'aufklappen');
        oldHeight = element.find('.logentries').height();
        //container.scrollTop(oldHeight);
        });
</script>

</body>
</html>